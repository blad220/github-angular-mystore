<!-- *ngIf="items.length"  -->
<!-- <cdk-virtual-scroll-viewport itemSize="50" minBufferPx="200" maxBufferPx="400"  style="  height: 200px;
width: 200px;
border: 1px solid black;">
    <div *cdkVirtualFor="let item of ds" style="height: 50px;">{{item || 'Loading...'}}</div>
  </cdk-virtual-scroll-viewport> -->
<div class="order-container">

    <!-- <mat-grid-list cols="3" rowHeight="100%"> -->

    <!-- <mat-grid-tile [colspan]="2" [rowspan]="1"> -->

    <mat-vertical-stepper linear #stepper>
        <mat-step [stepControl]="firstFormGroup" completed>
            <form [formGroup]="firstFormGroup">

                <ng-template class="form-label-name" matStepLabel>
                    {{setFirstFormLabel()}}
                </ng-template>

                <mat-form-field appearance="fill">
                    <mat-label>Name</mat-label>
                    <input matInput placeholder="Enter your Name.." formControlName="firstCtrlName" required>
                    <div class="err">Error</div>
                    <mat-error *ngIf="firstCtrlName.invalid">Name wrong value</mat-error>
                </mat-form-field>

                <mat-divider></mat-divider>

                <mat-form-field appearance="fill">
                    <mat-label>Sername</mat-label>
                    <input matInput placeholder="Enter your Sername.." formControlName="firstCtrlSername" required>
                    <div class="err">Error</div>
                    <mat-error *ngIf="firstCtrlSername.invalid">Sername wrong value</mat-error>
                </mat-form-field>

                <mat-divider></mat-divider>

                <mat-form-field appearance="fill">
                    <mat-label>Email</mat-label>
                    <input matInput type="email" pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$"
                        placeholder="email@example.com" formControlName="firstCtrlEmail" required>
                    <div class="err">Error</div>
                    <mat-error *ngIf="firstCtrlEmail.invalid">Email invalid</mat-error>
                </mat-form-field>

                <mat-divider></mat-divider>

                <mat-form-field appearance="fill" class="example-full-width">
                    <mat-label>Telephone</mat-label>
                    <input matInput #telNum type="tel" formControlName="firstCtrlTel" (focusout)="checkTelFocusOut();"
                        pattern="^[\+38]{3}\(+[0-9]{3}\)+[0-9]{3}\-[0-9]{2}\-[0-9]{2}$" maxlength="19"
                        placeholder="+38(066)003-80-56" required>
                    <!-- <mat-icon matSuffix>mode_edit</mat-icon> -->
                    <div class="err">Error</div>
                    <mat-error *ngIf="firstCtrlTel.invalid">Mobile is wrong</mat-error>
                </mat-form-field>

                <mat-divider></mat-divider>


                <!-- <h4>native html select</h4>
                <mat-form-field class="example-full-width">
                  <mat-label>Choose one</mat-label>
                  <select matNativeControl formControlName="nativeSelectFormControl"  [errorStateMatcher]="matcher">
                    <option value=""></option>
                    <option value="valid" selected>Valid option</option>
                    <option value="invalid">Invalid option</option>
                  </select>
                  <mat-error *ngIf="firstFormGroup.controls['nativeSelectFormControl'].hasError('required')">You must make a selection</mat-error>
                  <mat-error *ngIf="firstFormGroup.controls['nativeSelectFormControl'].hasError('pattern') && !nativeSelectFormControl.hasError('required')">
                    Your selection is invalid
                  </mat-error>
                </mat-form-field> -->
                <!-- <div *ngIf="!unionMassiveCompanyT">Loading</div> -->
                
                <mat-form-field *ngIf="!unionMassiveCompanyT" class="example-full-width adressFormGroup">
                    <mat-label>Loading...</mat-label>
                    <mat-select  formControlName="firstCtrlCity" (opened)="menuOpened()" (closed)="menuClosed()"
                        #singleSelect required>
                    </mat-select>
                </mat-form-field>
                <mat-form-field *ngIf="unionMassiveCompanyT" class="example-full-width adressFormGroup">
                    <mat-label>{{(unionMassiveCompanyT) ? 'Town' : 'Loading...'}}</mat-label>
                    <mat-select formControlName="firstCtrlCity" (opened)="menuOpened()" (closed)="menuClosed()" 
                        (selectionChange)="townSelectChange()" #singleSelect required>

                        <mat-option style="text-overflow: ellipsis;">
                            <ngx-mat-select-search [formControl]="firstCtrlCityFilteringCtrl" [searching]="searching"
                                placeholderLabel="Find Town..." noEntriesFoundLabel="No matching Town found..">
                            </ngx-mat-select-search>
                        </mat-option>
                        <mat-option style="height: 0px;" *ngIf="selected" [value]="selected">{{selected.nShortName}}
                        </mat-option>
                        <div style="overflow: auto; ">
                            <!-- <mat-option value="">None</mat-option> -->


                            <cdk-virtual-scroll-viewport itemSize="30" style="  height: 200px; width: 100%;">
                                <mat-option [title]="((item.Description) ? item.Description : item.name) + 
                                ((item.nNovaPoshta) ? ' | Novaposta' : '' ) +
                                ((item.nDelivery) ? ' | Delivery' : '' )"
                                    *cdkVirtualFor="let item of _dataStream, let i = index" style="height: 50px;"
                                    [value]="item">
                                <div *ngIf="(item.nNovaPoshta)" class="order-shipping-logo novaPoshta"></div>
                                <div *ngIf="(item.nDelivery)" class="order-shipping-logo delivery"></div>    
                                    {{
                                ((item.Description) ? item.Description : item.name) 
                            }}
                                </mat-option>
                            </cdk-virtual-scroll-viewport>

                            <!-- <cdk-virtual-scroll-viewport itemSize="50" style="  height: 200px;
                    width: 200px;
                    border: 1px solid black;">
                        <div *cdkVirtualFor="let item of ds" style="height: 50px;">{{item || 'Loading...'}}</div>
                      </cdk-virtual-scroll-viewport> -->

                            <!-- <mat-option *ngFor="let item of filteredServerSideNovaPoshta | async" [value]="item"> -->
                            <!-- {{item.Description}} -->
                            <!-- </mat-option> -->

                        </div>


                        <!-- <mat-option value="valid">Valid option</mat-option> -->
                        <!-- <mat-option value="invalid">Invalid option</mat-option> -->
                    </mat-select>
                    <mat-error *ngIf="firstFormGroup.controls['firstCtrlCity'].hasError('required')">You must make a
                        selection</mat-error>
                    <mat-error
                        *ngIf="firstFormGroup.controls['firstCtrlCity'].hasError('pattern') && !nativeSelectFormControl.hasError('required')">
                        Your selection is invalid
                    </mat-error>
                </mat-form-field>
                <!-- <p>
                    Selected Bank: {{firstFormGroup.controls['bankServerSideCtrl'].value?.name}}
                  </p> -->


                <!-- <mat-form-field class="example-full-width" style="width: 85%;" appearance="fill">
                    <mat-label>City</mat-label>
                    <input style="padding: 5px;" matInput placeholder="City of delivery"
                        formControlName="firstCtrlCity" (keyup)="getCity()" required>
                    <mat-error *ngIf="firstFormGroup.controls['firstCtrlCity'].errors">
                        {{firstFormGroup.controls['firstCtrlCity'].errors['myNameValidator']}}</mat-error>
                    <mat-error *ngIf="receivedTmpDisplay !== undefined && receivedTmpDisplay.errors">{{receivedTmpDisplay.errors}}</mat-error>
                    
                        
                        <mat-divider></mat-divider>
                        <mat-error *ngIf="firstCtrlCity.invalid">City is wrong</mat-error>
                        <mat-error >{{receivedTmp.success}}</mat-error>

                        

                        
                        <div [@slideVertical]="receivedTmpDisplay !== undefined && receivedTmpDisplay.success && showCity ? 'show' : null">
                    <div style="overflow: hidden;" 
                        *ngFor="let item of jokesNovaPoshta$  | async">
                        <div class="cart-item" style="cursor: pointer;" 
                            (click)="chooseCity(item)">

                            <img class="example-option-img" aria-hidden [src]="" height="25">
                            <span style="justify-content: start;" class="cart-item-inner">
                                {{item | json}}
                            </span>
                            

                   
                        </div>

                        
                        
                       
                    </div>
                </div>
                    

                    <div class="err">Error</div>
                     -->
                <!-- <mat-error *ngIf="firstCtrlCity.invalid">City is wrong</mat-error> -->


                <!-- </mat-form-field> -->
                <!-- <mat-error >{{receivedTmp.errors}}</mat-error> -->

                <mat-divider></mat-divider>

                <div>
                    <button class="formButton" mat-flat-button color="primary" matStepperNext>Next</button>
                </div>

            </form>
        </mat-step>

        <mat-step [stepControl]="secondFormGroup" errorMessage="Address is required." completed>
            <form [formGroup]="secondFormGroup">
                <ng-template matStepLabel>{{setSecondFormLabel()}}</ng-template>

                <!-- <p *ngIf="formCheck">{{formCheck.controls['thirdCtrl'].value}}</p> -->

                <!-- <mat-form-field>
                            <mat-label>Address</mat-label>
                            <input matInput placeholder="Ex. 1 Main St, New York, NY" formControlName="thirdCtrl"
                                required>
                        </mat-form-field> -->
                <!-- selected.nNovaPoshta -->
                <!-- selected.nDelivery -->
                <app-shipping shippingInfo=choose [(shippingCost)]="priceNovaPoshta" [(shippingHave)]="selected"
                    (onFormGroupChange)="onFormGroupChangeEvent($event)"></app-shipping>
                <!-- <mat-error *ngIf="secondFormGroup.invalid">Pick your shipping</mat-error> -->
                <div>
                    <button class="formButton" mat-flat-button color="primary" matStepperPrevious>Back</button>
                    <button class="formButton" mat-flat-button color="primary" matStepperNext>Next</button>
                </div>
            </form>
        </mat-step>

        <mat-step [stepControl]="thirdFormGroup" errorMessage="Address is required." aria-expanded="true" completed>
            <form [formGroup]="thirdFormGroup">
                <ng-template matStepLabel>{{setThirdFormLabel()}}</ng-template>
                <mat-form-field class="adressFormGroup">
                    <mat-label>Address</mat-label>
                    <textarea placeholder="Ex. 1 Main St, New York, NY" rows=2 maxlength=80
                        formControlName="thirdCtrlAdress" matInput required></textarea>
                    <div class="err">Error</div>
                    <mat-error *ngIf="thirdCtrlAdress.invalid">Address is required</mat-error>
                </mat-form-field>
                <div class="cart-item" *ngFor="let item of DeliveryCitys();">
                    <span *ngIf="!item.error">{{item.Present}}</span>
                    <span *ngIf="item.error">{{item.error}}</span>
                </div>

                <mat-divider></mat-divider>

                <div>
                    <button class="formButton" mat-flat-button color="primary" matStepperPrevious>Back</button>
                    <button class="formButton" mat-flat-button color="primary" matStepperNext>Next</button>
                </div>
            </form>
        </mat-step>

        <mat-step>
            <mat-card>
                <mat-card-header>
                    <ng-template matStepLabel>Done</ng-template>
                </mat-card-header>
                <p>You are now done.</p>
                <mat-card-content>
                    <p>{{this.firstFormGroup.value | json}}</p>
                    <p>{{this.secondFormGroup.value | json}}</p>
                    <p>{{this.thirdFormGroup.value | json}}</p>
                </mat-card-content>

                <mat-card-actions>
                    <!-- <p>{{this.thirdFormGroup.value | json}}</p> -->
                    <div>
                        <button class="formButton" mat-flat-button color="primary" matStepperPrevious>Back</button>
                        <button class="formButton" mat-flat-button color="primary"
                            (click)="stepper.reset()">Reset</button>
                    </div>
                </mat-card-actions>
            </mat-card>
        </mat-step>
    </mat-vertical-stepper>

    <!-- </mat-grid-tile> -->

    <!-- <mat-grid-tile [colspan]="1" [rowspan]="1"> -->

    <mat-card class="example-card">
        <mat-card-header>
            <mat-card-title>Cart:</mat-card-title>
            <mat-card-subtitle>My Store</mat-card-subtitle>
        </mat-card-header>

        <mat-card-content>
            <div class="cart-item" *ngFor="let item of items; index as productId">

                <span>
                    <a [title]="item.name + ' details'" [routerLink]="['/products', item.id]">{{item.name}}</a>
                </span>

                <div class="cart-item-inner">
                    <span class="cart-item-col">
                        {{item.col}}
                    </span>
                    <span class="cart-item-price">{{item.price * item.col | currency: 'UAH' : 'symbol-narrow'}}</span>
                </div>

            </div>
            <p>Total: {{getSumPrice(items) | currency: 'UAH' : 'symbol-narrow'}}</p>
        </mat-card-content>
        <mat-card-actions>
            <button mat-button routerLink="/cart">Edit cart</button>
            <!-- <button mat-button (click)="getLog()">SHARE</button> -->
        </mat-card-actions>


        <!-- {{DeliveryCity()}} -->
        <!-- {{receivedTmp2.data[0].Addresses[0].DeliveryCity}} -->



        <!-- {{DeliveryCity() | json}} -->




    </mat-card>

    <!-- </mat-grid-tile> -->

    <!-- </mat-grid-list> -->
</div>

<!-- <mat-card *ngFor="let item of jokesNovaPoshta$ | async">
    
    <div  class="joke-content flex">
      <span class="vote">{{50 }}</span>
      <span class="stretch" [innerHTML]="item.Description"></span>
      <button mat-icon-button>
        <mat-icon class="heart" aria-label="Like">favorite</mat-icon>
      </button>
    </div>

  </mat-card> -->

<!-- <div class="example-radio-button " *ngFor="let item of items_shipping | async; let i = index ">
    <div class="shipping-item main">
        <span>{{ item.type }}</span>
        <span>{{getSumPrice(item.stages) | currency }}</span>
    </div>
    <div class=" more ">
		<div class="shipping-item more" *ngFor="let stage of item.stages ">
			<span *ngIf="stage.type">{{ stage.type }}</span>
			<span *ngIf="stage.type">{{ stage.price | currency }}</span>
		</div>
    </div>
</div> -->